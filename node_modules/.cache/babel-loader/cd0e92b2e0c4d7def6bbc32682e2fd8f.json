{"ast":null,"code":"import { dialogsAPI } from \"../API/api\";\nimport { updateObjectInArray } from \"../utils/objectHelpers\";\nconst SEND_MESSAGE = \"network/dialogs/SEND_MESSAGE\";\nconst START_CHATTING = \"network/dialogs/START_CHATTING\";\nconst SET_DIALOGS = \"network/dialogs/SET_DIALOGS\";\nconst GET_DIALOGS_MESSAGES = \"network/dialogs/GET_DIALOGS_MESSAGES\";\nconst UPDATE_ACTIVE_DIALOG = \"network/dialogs/UPDATE_ACTIVE_DIALOG\";\nconst UPDATE_MESSAGE_VIEWED = \"network/dialogs/UPDATE_MESSAGE_VIEWED\";\nconst ADD_MESSAGE_IN_SPAM = \"network/dialogs/ADD_MESSAGE_IN_SPAM\";\nconst DELETE_MESSAGE = \"network/dialogs/DELETE_MESSAGE\";\nconst RETURN_MESSAGE = \"network/dialogs/RETURN_MESSAGE\";\nlet initialisation = {\n  dialogs: [],\n  activeDialogId: null,\n  messages: null,\n  messagesItems: null,\n  messagePageSize: 20,\n  numberOfPage: 1,\n  spamMessagesId: [],\n  deleteMessagesId: []\n};\n\nlet dialogsReducer = (state = initialisation, action) => {\n  switch (action.type) {\n    case SEND_MESSAGE:\n      {\n        return { ...state,\n          // item: [...state.messages.items, action.newMessage.message],\n          messagesItems: [...state.messages.items, action.newMessage]\n        };\n      }\n\n    case START_CHATTING:\n      {\n        return { ...state,\n          dialogs: [...state.dialogs, action.dialog]\n        };\n      }\n\n    case SET_DIALOGS:\n      {\n        return { ...state,\n          dialogs: action.dialogs\n        };\n      }\n\n    case GET_DIALOGS_MESSAGES:\n      {\n        return { ...state,\n          messages: action.messages,\n          messagesItems: action.messages.items\n        };\n      }\n\n    case UPDATE_ACTIVE_DIALOG:\n      {\n        return { ...state,\n          activeDialogId: action.userId\n        };\n      }\n\n    case ADD_MESSAGE_IN_SPAM:\n      {\n        return { ...state,\n          spamMessagesId: [...state.spamMessagesId, action.messageId],\n          messagesItems: updateObjectInArray(state.messagesItems, \"id\", action.messageId, {\n            body: \"Message is add to spam\"\n          })\n        };\n      }\n\n    case DELETE_MESSAGE:\n      {\n        debugger;\n        return { ...state,\n          deleteMessagesId: [...state.deleteMessagesId, action.messageId],\n          messagesItems: updateObjectInArray(state.messagesItems, \"id\", action.messageId, {\n            body: \"Message si deleted\"\n          })\n        };\n      }\n\n    case RETURN_MESSAGE:\n      {\n        return {\n          messagesItems: updateObjectInArray(state.messagesItems, \"id\", action.messageId, {\n            body: \"Message si deleted\"\n          })\n        };\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport const sendMessageAC = newMessage => ({\n  type: SEND_MESSAGE,\n  newMessage\n});\nexport const startChatting = dialog => ({\n  type: START_CHATTING,\n  dialog\n});\nexport const setDialogs = dialogs => ({\n  type: SET_DIALOGS,\n  dialogs\n});\nexport const getDialogMessages = messages => ({\n  type: GET_DIALOGS_MESSAGES,\n  messages\n});\nexport const updateActiveDialog = userId => ({\n  type: UPDATE_ACTIVE_DIALOG,\n  userId\n});\nexport const addMessageInSpam = message => ({\n  type: ADD_MESSAGE_IN_SPAM,\n  message\n});\nexport const deleteMessage = messageId => ({\n  type: DELETE_MESSAGE,\n  messageId\n});\nexport const returnMessage = messageId => ({\n  type: RETURN_MESSAGE,\n  messageId\n});\nexport const sendNewMessage = (userId, body) => async dispatch => {\n  const response = await dialogsAPI.sendMessage(userId, body);\n\n  if (response.data.resultCode === 0) {\n    dispatch(sendMessageAC(response.data.data.message));\n  }\n};\nexport const startDialog = userId => async dispatch => {\n  const response = await dialogsAPI.startChatting(userId);\n\n  if (response.resultCode === 0) {\n    dispatch(startChatting(response.data));\n  }\n};\nexport const getDialogs = () => async dispatch => {\n  const response = await dialogsAPI.getDialogs();\n  dispatch(setDialogs(response.data));\n};\nexport const getMessages = (userId, count, pageNumber) => async dispatch => {\n  const response = await dialogsAPI.getMassagesList(userId, count, pageNumber);\n  dispatch(getDialogMessages(response.data));\n};\nexport const setActiveDialog = userId => dispatch => {\n  dispatch(updateActiveDialog(userId));\n};\nexport const setMessageViewed = messageId => async dispatch => {\n  await dialogsAPI.viewedMessage(messageId);\n};\nexport const sendMessageInSpam = messageId => async dispatch => {\n  debugger;\n  const response = await dialogsAPI.addMassageToSpam(messageId);\n\n  if (response.data.resultCode === 0) {\n    dispatch(addMessageInSpam(response.data));\n  }\n};\nexport const deleteMessageForMe = messageId => async dispatch => {\n  await dialogsAPI.deleteMessageForMe(messageId);\n  dispatch(deleteMessage(messageId));\n};\nexport const restoreMessage = messageId => async dispatch => {\n  const response = await dialogsAPI.restoreMessage(messageId);\n  debugger;\n  dispatch(returnMessage(response.data));\n};\nexport default dialogsReducer;","map":{"version":3,"sources":["D:/react/net/project1/src/Redux/dialogsReducer.js"],"names":["dialogsAPI","updateObjectInArray","SEND_MESSAGE","START_CHATTING","SET_DIALOGS","GET_DIALOGS_MESSAGES","UPDATE_ACTIVE_DIALOG","UPDATE_MESSAGE_VIEWED","ADD_MESSAGE_IN_SPAM","DELETE_MESSAGE","RETURN_MESSAGE","initialisation","dialogs","activeDialogId","messages","messagesItems","messagePageSize","numberOfPage","spamMessagesId","deleteMessagesId","dialogsReducer","state","action","type","items","newMessage","dialog","userId","messageId","body","sendMessageAC","startChatting","setDialogs","getDialogMessages","updateActiveDialog","addMessageInSpam","message","deleteMessage","returnMessage","sendNewMessage","dispatch","response","sendMessage","data","resultCode","startDialog","getDialogs","getMessages","count","pageNumber","getMassagesList","setActiveDialog","setMessageViewed","viewedMessage","sendMessageInSpam","addMassageToSpam","deleteMessageForMe","restoreMessage"],"mappings":"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","sourcesContent":["import {dialogsAPI} from \"../API/api\";\r\nimport {updateObjectInArray} from \"../utils/objectHelpers\";\r\n\r\nconst SEND_MESSAGE = \"network/dialogs/SEND_MESSAGE\";\r\nconst START_CHATTING = \"network/dialogs/START_CHATTING\";\r\nconst SET_DIALOGS = \"network/dialogs/SET_DIALOGS\";\r\nconst GET_DIALOGS_MESSAGES = \"network/dialogs/GET_DIALOGS_MESSAGES\";\r\nconst UPDATE_ACTIVE_DIALOG = \"network/dialogs/UPDATE_ACTIVE_DIALOG\";\r\nconst UPDATE_MESSAGE_VIEWED = \"network/dialogs/UPDATE_MESSAGE_VIEWED\";\r\nconst ADD_MESSAGE_IN_SPAM = \"network/dialogs/ADD_MESSAGE_IN_SPAM\";\r\nconst DELETE_MESSAGE = \"network/dialogs/DELETE_MESSAGE\";\r\nconst RETURN_MESSAGE = \"network/dialogs/RETURN_MESSAGE\";\r\n\r\n\r\nlet initialisation = {\r\n    dialogs: [],\r\n    activeDialogId: null,\r\n    messages: null,\r\n    messagesItems: null,\r\n    messagePageSize: 20,\r\n    numberOfPage: 1,\r\n    spamMessagesId: [],\r\n    deleteMessagesId: [],\r\n\r\n};\r\n\r\n\r\nlet dialogsReducer = (state = initialisation, action) => {\r\n    switch (action.type) {\r\n        case SEND_MESSAGE: {\r\n            return {\r\n                ...state,\r\n                // item: [...state.messages.items, action.newMessage.message],\r\n                messagesItems: [...state.messages.items, (action.newMessage)],\r\n            }\r\n        }\r\n        case START_CHATTING: {\r\n            return {\r\n                ...state,\r\n                dialogs: [...state.dialogs, action.dialog]\r\n            }\r\n        }\r\n        case SET_DIALOGS: {\r\n            return {\r\n                ...state,\r\n                dialogs: action.dialogs,\r\n            }\r\n        }\r\n        case GET_DIALOGS_MESSAGES: {\r\n            return {\r\n                ...state,\r\n                messages: action.messages,\r\n                messagesItems: action.messages.items,\r\n            }\r\n        }\r\n        case UPDATE_ACTIVE_DIALOG: {\r\n            return {\r\n                ...state,\r\n                activeDialogId: action.userId,\r\n            }\r\n        }\r\n        case ADD_MESSAGE_IN_SPAM: {\r\n            return {\r\n                ...state,\r\n                spamMessagesId: [...state.spamMessagesId, action.messageId],\r\n                messagesItems: updateObjectInArray(state.messagesItems, \"id\", action.messageId, {body: \"Message is add to spam\"})\r\n            }\r\n        }\r\n        case DELETE_MESSAGE: {\r\n            debugger\r\n            return {\r\n                ...state,\r\n                deleteMessagesId: [...state.deleteMessagesId, action.messageId],\r\n                messagesItems: updateObjectInArray(state.messagesItems, \"id\", action.messageId, {body: \"Message si deleted\"})\r\n            }\r\n        }\r\n        case RETURN_MESSAGE: {\r\n            return {\r\n                messagesItems: updateObjectInArray(state.messagesItems, \"id\", action.messageId, {body: \"Message si deleted\"})\r\n            }\r\n        }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport const sendMessageAC = (newMessage) => ({type: SEND_MESSAGE, newMessage});\r\n\r\nexport const startChatting = (dialog) => ({type: START_CHATTING, dialog});\r\n\r\nexport const setDialogs = (dialogs) => ({type: SET_DIALOGS, dialogs});\r\n\r\nexport const getDialogMessages = (messages) => ({type: GET_DIALOGS_MESSAGES, messages})\r\n\r\nexport const updateActiveDialog = (userId) => ({type: UPDATE_ACTIVE_DIALOG, userId})\r\n\r\nexport const addMessageInSpam = (message) => ({type: ADD_MESSAGE_IN_SPAM, message})\r\n\r\nexport const deleteMessage = (messageId) => ({type: DELETE_MESSAGE, messageId})\r\n\r\nexport const returnMessage = (messageId) => ({type: RETURN_MESSAGE, messageId})\r\n\r\nexport const sendNewMessage = (userId, body) => async (dispatch) => {\r\n    const response = await dialogsAPI.sendMessage(userId, body)\r\n    if (response.data.resultCode === 0) {\r\n        dispatch(sendMessageAC(response.data.data.message))\r\n\r\n    }\r\n}\r\n\r\nexport const startDialog = (userId) => async (dispatch) => {\r\n    const response = await dialogsAPI.startChatting(userId)\r\n    if (response.resultCode === 0) {\r\n        dispatch(startChatting(response.data))\r\n    }\r\n}\r\n\r\nexport const getDialogs = () => async (dispatch) => {\r\n    const response = await dialogsAPI.getDialogs()\r\n    dispatch(setDialogs(response.data))\r\n}\r\n\r\nexport const getMessages = (userId, count, pageNumber) => async (dispatch) => {\r\n\r\n    const response = await dialogsAPI.getMassagesList(userId, count, pageNumber)\r\n    dispatch(getDialogMessages(response.data))\r\n}\r\n\r\nexport const setActiveDialog = (userId) => (dispatch) => {\r\n    dispatch(updateActiveDialog(userId))\r\n}\r\n\r\nexport const setMessageViewed = (messageId) => async (dispatch) => {\r\n    await dialogsAPI.viewedMessage(messageId)\r\n}\r\n\r\nexport const sendMessageInSpam = (messageId) => async (dispatch) => {\r\n    debugger\r\n    const response = await dialogsAPI.addMassageToSpam(messageId);\r\n    if (response.data.resultCode === 0) {\r\n        dispatch(addMessageInSpam(response.data))\r\n    }\r\n}\r\n\r\nexport const deleteMessageForMe = (messageId) => async (dispatch) => {\r\n    await dialogsAPI.deleteMessageForMe(messageId)\r\n    dispatch(deleteMessage(messageId))\r\n}\r\n\r\nexport const restoreMessage = (messageId) => async (dispatch) => {\r\n    const response = await dialogsAPI.restoreMessage(messageId)\r\n    debugger\r\n    dispatch(returnMessage(response.data))\r\n}\r\n\r\n\r\nexport default dialogsReducer\r\n"]},"metadata":{},"sourceType":"module"}