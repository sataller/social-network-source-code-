{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\react\\\\net\\\\project1\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\react\\\\net\\\\project1\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"D:\\\\react\\\\net\\\\project1\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:\\\\react\\\\net\\\\project1\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import React from\"react\";import{usersAPI}from\"../API/api\";import{updateObjectInArray}from\"../utils/objectHelpers\";import{followingStatus}from\"./profileReducer\";var FOLLOW=\"network/users/FOLLOW\";var UNFOLLOW=\"network/users/UNFOLLOW\";var SET_USERS=\"network/users/SET_USERS\";var SET_CURRENT_PAGE=\"network/users/SET_CURRENT_PAGE\";var SET_TOTAL_USERS_COUNT=\"network/users/SET_TOTAL_USERS_COUNT\";var TOGGLE_IS_FETCHING=\"network/users/TOGGLE_IS_FETCHING\";var FOLLOWING_IN_PROGRESS=\"network/users/FOLLOWING_IN_PROGRESS\";var initialization={users:[],pageSize:10,totalCount:0,currentPage:1,isFetching:false,followingInProgress:[],paginationSize:9};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialization;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:console.log(action.userId);return _objectSpread({},state,{users:updateObjectInArray(state.users,\"id\",action.userId,{followed:true})});case UNFOLLOW:console.log(action.userId);return _objectSpread({},state,{users:updateObjectInArray(state.users,\"id\",action.userId,{followed:false})});case SET_USERS:{return _objectSpread({},state,{users:_toConsumableArray(action.users)});}case SET_CURRENT_PAGE:{return _objectSpread({},state,{currentPage:action.currentPage});}case SET_TOTAL_USERS_COUNT:{return _objectSpread({},state,{totalCount:action.totalCount});}case TOGGLE_IS_FETCHING:{return _objectSpread({},state,{isFetching:action.isFetching});}case FOLLOWING_IN_PROGRESS:{return _objectSpread({},state,{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});}default:return state;}};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:FOLLOWING_IN_PROGRESS,isFetching:isFetching,userId:userId};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var setPage=function setPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalCount){return{type:SET_TOTAL_USERS_COUNT,totalCount:totalCount};};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var requestUsers=function requestUsers(currentPage,pageSize){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setPage(currentPage));dispatch(toggleIsFetching(true));_context.next=4;return usersAPI.getUsers(currentPage,pageSize);case 4:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};var followUnfolowMechanic=function followUnfolowMechanic(userId,success,act){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context2.next=3;return act(userId);case 3:data=_context2.sent;if(data.resultCode==0){dispatch(success(userId));dispatch(followingStatus(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());};export var follow=function follow(userId){return followUnfolowMechanic(userId,followSuccess,usersAPI.followUser);};export var unfollow=function unfollow(userId){return followUnfolowMechanic(userId,unfollowSuccess,usersAPI.unfollowUser);};export default usersReducer;","map":{"version":3,"sources":["D:/react/net/project1/src/Redux/usersReducer.js"],"names":["React","usersAPI","updateObjectInArray","followingStatus","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","FOLLOWING_IN_PROGRESS","initialization","users","pageSize","totalCount","currentPage","isFetching","followingInProgress","paginationSize","usersReducer","state","action","type","console","log","userId","followed","filter","id","toggleFollowingProgress","toggleIsFetching","setPage","setTotalUsersCount","followSuccess","unfollowSuccess","setUsers","requestUsers","dispatch","getUsers","data","items","followUnfolowMechanic","success","act","resultCode","follow","followUser","unfollow","unfollowUser"],"mappings":"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","sourcesContent":["import React from \"react\"\r\nimport {usersAPI} from \"../API/api\";\r\nimport {updateObjectInArray} from \"../utils/objectHelpers\";\r\nimport {followingStatus} from \"./profileReducer\";\r\n\r\nconst FOLLOW = \"network/users/FOLLOW\";\r\nconst UNFOLLOW = \"network/users/UNFOLLOW\";\r\nconst SET_USERS = \"network/users/SET_USERS\";\r\nconst SET_CURRENT_PAGE = \"network/users/SET_CURRENT_PAGE\";\r\nconst SET_TOTAL_USERS_COUNT = \"network/users/SET_TOTAL_USERS_COUNT\";\r\nconst TOGGLE_IS_FETCHING = \"network/users/TOGGLE_IS_FETCHING\";\r\nconst FOLLOWING_IN_PROGRESS = \"network/users/FOLLOWING_IN_PROGRESS\";\r\n\r\n\r\nlet initialization = {\r\n    users: [],\r\n    pageSize: 10,\r\n    totalCount: 0,\r\n    currentPage: 1,\r\n    isFetching: false,\r\n    followingInProgress: [],\r\n    paginationSize:9,\r\n}\r\nlet usersReducer = (state = initialization, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            console.log(action.userId)\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, \"id\", action.userId, {followed: true}),\r\n            }\r\n\r\n        case UNFOLLOW:\r\n            console.log(action.userId)\r\n\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, \"id\", action.userId, {followed: false})\r\n            }\r\n        case SET_USERS: {\r\n            return {...state, users: [...action.users]}\r\n\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {...state, currentPage: action.currentPage}\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return {...state, totalCount: action.totalCount}\r\n        }\r\n\r\n        case TOGGLE_IS_FETCHING: {\r\n            return {...state, isFetching: action.isFetching}\r\n        }\r\n\r\n        case FOLLOWING_IN_PROGRESS: {\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching ?\r\n                    [...state.followingInProgress, action.userId] :\r\n                    state.followingInProgress.filter(id => id != action.userId)\r\n            }\r\n        }\r\n\r\n        default:\r\n            return state\r\n\r\n    }\r\n}\r\n\r\nexport let toggleFollowingProgress = (isFetching, userId) => ({type: FOLLOWING_IN_PROGRESS, isFetching, userId})\r\nexport let toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\r\nexport let setPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\r\nexport let setTotalUsersCount = (totalCount) => ({type: SET_TOTAL_USERS_COUNT, totalCount})\r\nexport let followSuccess = (userId) => ({type: FOLLOW, userId})\r\nexport let unfollowSuccess = (userId) => ({type: UNFOLLOW, userId})\r\nexport let setUsers = (users) => ({type: SET_USERS, users})\r\n\r\n\r\nexport let requestUsers = (currentPage, pageSize) => {\r\n    return (async (dispatch) => {\r\n        dispatch(setPage(currentPage))\r\n        dispatch(toggleIsFetching(true));\r\n        const data = await usersAPI.getUsers(currentPage, pageSize);\r\n        dispatch(toggleIsFetching(false))\r\n\r\n        dispatch(setUsers(data.items))\r\n        dispatch(setTotalUsersCount(data.totalCount))\r\n    })\r\n}\r\n\r\nlet followUnfolowMechanic = (userId, success, act) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgress(true, userId))\r\n        let data = await act(userId)\r\n        if (data.resultCode == 0) {\r\n            dispatch(success(userId))\r\n            dispatch(followingStatus(userId))\r\n        }\r\n        dispatch(toggleFollowingProgress(false, userId))\r\n    }\r\n}\r\n\r\nexport let follow = (userId) => {\r\n    return followUnfolowMechanic(userId, followSuccess, usersAPI.followUser);\r\n}\r\n\r\nexport let unfollow = (userId) => {\r\n    return followUnfolowMechanic(userId, unfollowSuccess, usersAPI.unfollowUser);\r\n}\r\n\r\nexport default usersReducer\r\n"]},"metadata":{},"sourceType":"module"}